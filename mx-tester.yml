name: mjolnir

up:
  before:
    # Launch the reverse proxy, listening for connections *only* on the local host.
    - docker run --rm --network host --name mjolnir-test-reverse-proxy -p 127.0.0.1:8081:80 -v $MX_TEST_CWD/test/nginx.conf:/etc/nginx/nginx.conf:ro -d nginx
run:
  - yarn test:integration
down:
  finally:
    - docker stop mjolnir-test-reverse-proxy || true
homeserver:
  # Basic configuration.
  server_name: localhost:9999
  public_baseurl: http://localhost:9999
  registration_shared_secret: REGISTRATION_SHARED_SECRET

  # Getting rid of throttling.
  rc_message:
    per_second: 10000
    burst_count: 10000

  rc_registration:
    per_second: 10000
    burst_count: 10000

  rc_login:
    address:
      per_second: 10000
      burst_count: 10000
    account:
      per_second: 10000
      burst_count: 10000
    failed_attempts:
      per_second: 10000
      burst_count: 10000

  rc_admin_redaction:
    per_second: 10000
    burst_count: 10000

  rc_joins:
    local:
      per_second: 10000
      burst_count: 10000
    remote:
      per_second: 10000
      burst_count: 10000
